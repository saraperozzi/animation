<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Web reference</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="Peroz">
  <!-- <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,700" rel="stylesheet"> -->
  <link rel="stylesheet" href="css/styles.css?v=1.0">
</head>

<body>
  <div class="intro">
    <div class="content">
      <h1>My web reference website</h1>
      <p>web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.web repository for web references.</p>
    </div>
  </div>
  <div class="filtered-content">
    <div class="filter-container">
        <div class="filter" id="All">
            <p>
              All
              </p>
          </div>
    </div>
    <div class="container">
    </div>
  </div>

  

  <script type="text/javascript">
  
  
  
  var container = document.querySelector(".container");
  var link = [
    {name:"Ciccio", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag2", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"},
    {name:"Ciccio", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag2", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"},
    {name:"Pippo", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag3", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"},
    {name:"Flex", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag1", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"},
    {name:"Ciccio", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag2", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"},
    {name:"Pippo", description:"website reference for flex", img:"../img/peroz.png", tags:"Tag3", href:"https://css-tricks.com/snippets/css/a-guide-to-flexbox/"}
  ]

  //cycle that create an element for every 'link' json line
  for (i=0 ; i<link.length ; i++){
    //variables
    var newElement = document.createElement("div");
    var newText = document.createElement("p");
    var div = container.appendChild(newElement);
    var text = document.createTextNode(link[i].name);
    //create and append new elements for each one of the object "link" element
    newElement.dataset.tag = link[i].tags;
    newElement.dataset.href = link[i].href;
    newText.classList.add("button-content");
    newElement.classList.add("button");
    div.appendChild(newText).appendChild(text);
    }

    // Calculates height for boxes
  var elements = document.querySelectorAll('.button');
  for (i=0; i<elements.length; i++){
    var w = elements[i].clientWidth;
    elements[i].style.height = w; 
  };

  // Create a no-duplicates array of all tags
  var filters = [];
  for (i=0; i<elements.length; i++){
    filters[i] = elements[i].dataset.tag;
  }
  
    var tags_no_duplicates = []
    for (i=0; i<filters.length; i++){
      if (tags_no_duplicates.indexOf(filters[i]) == -1){
        tags_no_duplicates.push (filters[i]);
      }
    }

  //function open link on click on click
  container.addEventListener('click',function(event){
    var target = event.target;
    window.open(target.dataset.href);
  });
  
  //Create filter div starting from no-duplicate array of tags
    for (i=0; i<tags_no_duplicates.length; i++){
    var filter_container = document.querySelector('.filter-container');
    var newTag = document.createElement("div");
    var tag_div = filter_container.appendChild(newTag);
    var p = document.createElement("p");
    var text = document.createTextNode(tags_no_duplicates[i]);
    

    // //create and append new elements for each one of the tag element
    newTag.classList.add('filter');
    newTag.setAttribute('id',tags_no_duplicates[i])
    tag_div.appendChild(p).appendChild(text);
   }

   //filters
  var filter = document.querySelector('.filter-container');
  var filter_button = document.querySelectorAll('.filter');
  
  filter.addEventListener('click',function(event){
    var selected_filter = event.target.id;
    var selected_class = event.target.classList;
    var p_filter = event.target.children;
    console.log(p_filter[0].classList.length)


    for (i=0; i<filter_button.length; i++){
      filter_button[i].classList.remove('selected-filter');
      for (i=0; i<=p_filter[0].classList.length;i++){
        p_filter[i].classList.remove('p_selected');
      }
      // p_filter[i].classList.remove('p_selected');
    }
    
      for (i=0; i<selected_class.length; i++){
      if (selected_class[i] !== 'filter-container'){
        event.target.classList.add('selected-filter');
        for (i=0; i<=p_filter[0].classList.length;i++){
        p_filter[i].classList.add('p_selected');
      }

        // p_filter[i].classList.add('p_selected');
      }
      
     }
    
    for(i=0; i<link.length;i++){
      if ( selected_filter === 'All' || selected_filter === ''){
        elements[i].classList.remove('show','hide');
      }
      
      else if( selected_filter === elements[i].dataset.tag){
        elements[i].classList.add('show');
        elements[i].classList.remove('hide');
      }
      else{
        elements[i].classList.add('hide');
        elements[i].classList.remove('show');
      }
    }
  })



  </script>

</body>

</html>